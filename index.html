<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Issue Reporter - Production Ready</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- EmailJS SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --info-color: #17a2b8;
            --dark-color: #2c3e50;
            --light-color: #ecf0f1;
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-success: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --gradient-admin: linear-gradient(135deg, #434343 0%, #000000 100%);
            --shadow-soft: 0 8px 30px rgba(0, 0, 0, 0.08);
            --shadow-medium: 0 15px 35px rgba(0, 0, 0, 0.1);
            --shadow-large: 0 25px 50px rgba(0, 0, 0, 0.15);
            --border-radius: 12px;
            --border-radius-lg: 20px;
            --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header Styles */
        header {
            background: var(--gradient-primary);
            color: white;
            padding: 1rem 0;
            box-shadow: var(--shadow-medium);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 L100,0 L100,100 Z" fill="rgba(255,255,255,0.1)"/></svg>');
            background-size: cover;
        }
        
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 2;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo i {
            font-size: 2rem;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }
        
        .nav-links {
            display: flex;
            list-style: none;
        }
        
        .nav-links li {
            margin-left: 1.5rem;
        }
        
        .nav-links a {
            color: white;
            text-decoration: none;
            transition: var(--transition);
            padding: 0.5rem 1.2rem;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }
        
        .nav-links a::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            transition: left 0.4s ease;
            z-index: -1;
        }
        
        .nav-links a:hover::before {
            left: 0;
        }
        
        .nav-links a:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .nav-links a.active {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        /* Main Content */
        main {
            padding: 2rem 0;
            flex: 1;
        }
        
        .page-title {
            text-align: center;
            margin-bottom: 2.5rem;
            color: var(--primary-color);
            position: relative;
        }
        
        .page-title::after {
            content: '';
            display: block;
            width: 80px;
            height: 4px;
            background: var(--gradient-secondary);
            margin: 15px auto;
            border-radius: 2px;
        }
        
        .form-container {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-soft);
            padding: 2.5rem;
            max-width: 800px;
            margin: 0 auto;
            border: 1px solid rgba(255, 255, 255, 0.3);
            transform: translateY(20px);
            opacity: 0;
            animation: fadeInUp 0.6s ease forwards;
        }
        
        @keyframes fadeInUp {
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .security-notice {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border: 1px solid #ffeaa7;
            border-radius: var(--border-radius);
            padding: 1.2rem;
            margin-bottom: 1.5rem;
            color: #856404;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: var(--shadow-soft);
        }
        
        .success-message {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border: 1px solid #c3e6cb;
            border-radius: var(--border-radius);
            padding: 1.2rem;
            margin-bottom: 1.5rem;
            color: #155724;
            display: none;
            align-items: center;
            gap: 12px;
            box-shadow: var(--shadow-soft);
        }
        
        .success-message.show {
            display: flex;
            animation: popIn 0.5s ease forwards;
        }
        
        @keyframes popIn {
            0% {
                transform: scale(0.9);
                opacity: 0;
            }
            70% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        .secure-connection {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1.5rem;
            color: var(--success-color);
            font-weight: 600;
            padding: 1rem;
            background: rgba(39, 174, 96, 0.1);
            border-radius: var(--border-radius);
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 1.8rem;
            position: relative;
        }
        
        label {
            display: block;
            margin-bottom: 0.6rem;
            font-weight: 600;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .required::after {
            content: " *";
            color: var(--accent-color);
        }
        
        input[type="text"],
        input[type="password"],
        select,
        textarea {
            width: 100%;
            padding: 1rem 1.2rem;
            border: 2px solid #e1e8ed;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            background: white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        input[type="text"]:focus,
        input[type="password"]:focus,
        select:focus,
        textarea:focus {
            border-color: var(--secondary-color);
            outline: none;
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.2);
            transform: translateY(-2px);
        }
        
        /* Improved Password Field */
        .password-container {
            position: relative;
        }
        
        .toggle-password {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            font-size: 1.1rem;
            transition: var(--transition);
        }
        
        .toggle-password:hover {
            color: var(--secondary-color);
        }
        
        textarea {
            min-height: 150px;
            resize: vertical;
        }
        
        .char-counter {
            text-align: right;
            font-size: 0.875rem;
            color: #666;
            margin-top: 0.25rem;
        }
        
        .checkbox-group {
            display: flex;
            align-items: flex-start;
            margin-bottom: 1.8rem;
            padding: 1rem;
            background: rgba(52, 152, 219, 0.05);
            border-radius: var(--border-radius);
            transition: var(--transition);
        }
        
        .checkbox-group:hover {
            background: rgba(52, 152, 219, 0.1);
            transform: translateX(5px);
        }
        
        .checkbox-group input {
            margin-right: 0.8rem;
            margin-top: 0.25rem;
        }
        
        .submit-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 1.2rem 2rem;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            box-shadow: var(--shadow-soft);
            position: relative;
            overflow: hidden;
        }
        
        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }
        
        hr {
            border: none;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            margin: 1.8rem 0;
        }
        
        /* Content sections */
        .content-section {
            display: none;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-soft);
            padding: 2.5rem;
            max-width: 1000px;
            margin: 0 auto;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .content-section.active {
            display: block;
            animation: fadeInUp 0.6s ease forwards;
        }
        
        .home-content {
            text-align: center;
        }
        
        .home-content h2 {
            margin-bottom: 1.2rem;
            color: var(--primary-color);
            font-size: 2.5rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .home-content p {
            margin-bottom: 1.8rem;
            font-size: 1.2rem;
            color: #555;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .feature-cards {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-top: 3rem;
            gap: 1.5rem;
        }
        
        .feature-card {
            flex: 1;
            min-width: 250px;
            background: white;
            border-radius: var(--border-radius-lg);
            padding: 2rem;
            text-align: center;
            box-shadow: var(--shadow-soft);
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.5);
            position: relative;
            overflow: hidden;
        }
        
        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }
        
        .feature-card:nth-child(2)::before {
            background: var(--gradient-secondary);
        }
        
        .feature-card:nth-child(3)::before {
            background: var(--gradient-success);
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-large);
        }
        
        .feature-card i {
            font-size: 3rem;
            margin-bottom: 1.5rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .feature-card h3 {
            margin-bottom: 1rem;
            color: var(--primary-color);
            font-size: 1.4rem;
        }
        
        .feature-card p {
            color: #666;
            line-height: 1.6;
        }
        
        .issues-list {
            margin-top: 1.5rem;
        }
        
        .issue-item {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1.2rem;
            border-left: 5px solid var(--secondary-color);
            box-shadow: var(--shadow-soft);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        
        .issue-item:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }
        
        .issue-title {
            font-weight: bold;
            margin-bottom: 0.6rem;
            color: var(--primary-color);
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .issue-meta {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.8rem;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .issue-meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .issue-actions {
            display: flex;
            gap: 0.8rem;
            margin-top: 1.2rem;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        }
        
        .btn-danger {
            background: var(--gradient-secondary);
            color: white;
        }
        
        .btn-success {
            background: var(--gradient-success);
            color: white;
        }
        
        .btn-info {
            background: var(--gradient-primary);
            color: white;
        }
        
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 0.4rem 1rem;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .status-open {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
        }
        
        .status-in-progress {
            background: rgba(243, 156, 18, 0.1);
            color: #f39c12;
        }
        
        .status-resolved {
            background: rgba(39, 174, 96, 0.1);
            color: #27ae60;
        }
        
        .status-closed {
            background: rgba(127, 140, 141, 0.1);
            color: #7f8c8d;
        }
        
        .priority-high {
            border-left-color: var(--accent-color);
        }
        
        .priority-medium {
            border-left-color: var(--warning-color);
        }
        
        .priority-low {
            border-left-color: var(--success-color);
        }
        
        .no-issues {
            text-align: center;
            padding: 3rem;
            color: #666;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-soft);
        }
        
        .filters {
            display: flex;
            gap: 1.2rem;
            margin-bottom: 1.8rem;
            flex-wrap: wrap;
            background: white;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-soft);
        }
        
        .filter-group {
            flex: 1;
            min-width: 200px;
        }
        
        .filter-group label {
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            display: block;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 2.5rem;
            flex-wrap: wrap;
            gap: 1.2rem;
        }
        
        .stat-card {
            background: white;
            padding: 1.8rem 1.2rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-soft);
            text-align: center;
            flex: 1;
            min-width: 150px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }
        
        .stat-card:nth-child(2)::before {
            background: var(--gradient-secondary);
        }
        
        .stat-card:nth-child(3)::before {
            background: var(--gradient-success);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }
        
        .about-content h2 {
            margin-bottom: 1.2rem;
            color: var(--primary-color);
        }
        
        .about-content p {
            margin-bottom: 1.8rem;
            line-height: 1.7;
            color: #555;
        }
        
        .team-members {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            margin-top: 2.5rem;
            gap: 1.5rem;
        }
        
        .team-member {
            flex: 1;
            min-width: 200px;
            text-align: center;
            background: white;
            padding: 2rem 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-soft);
            transition: var(--transition);
        }
        
        .team-member:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-medium);
        }
        
        .member-photo {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--gradient-primary);
            margin: 0 auto 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.2rem;
            color: white;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }
        
        /* Admin Panel Styles */
        .admin-login {
            max-width: 500px;
            margin: 0 auto;
            text-align: center;
        }
        
        .admin-login h2 {
            margin-bottom: 1.5rem;
            color: var(--primary-color);
        }
        
        .admin-login-form {
            background: white;
            padding: 2rem;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-soft);
        }
        
        .admin-panel {
            display: none;
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .admin-actions {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .admin-issue-item {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1.2rem;
            border-left: 5px solid var(--secondary-color);
            box-shadow: var(--shadow-soft);
            transition: var(--transition);
        }
        
        .admin-issue-item.priority-high {
            border-left-color: var(--accent-color);
        }
        
        .admin-issue-item.priority-medium {
            border-left-color: var(--warning-color);
        }
        
        .admin-issue-item.priority-low {
            border-left-color: var(--success-color);
        }
        
        .admin-issue-item:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }
        
        .admin-issue-title {
            font-weight: bold;
            margin-bottom: 0.6rem;
            color: var(--primary-color);
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .admin-issue-meta {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.8rem;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .admin-issue-actions {
            display: flex;
            gap: 0.8rem;
            margin-top: 1.2rem;
            flex-wrap: wrap;
        }
        
        .admin-status-select {
            padding: 0.5rem;
            border-radius: var(--border-radius);
            border: 1px solid #e1e8ed;
            font-size: 0.9rem;
            width: 150px;
        }
        
        .admin-email-notification {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border: 1px solid #bbdefb;
            border-radius: var(--border-radius);
            padding: 1rem;
            margin-bottom: 1.5rem;
            color: #1565c0;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: var(--shadow-soft);
        }
        
        /* Database Status Indicator */
        .db-status {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            padding: 0.8rem;
            border-radius: var(--border-radius);
            font-weight: 600;
            gap: 10px;
        }
        
        .db-status.online {
            background: rgba(39, 174, 96, 0.1);
            color: var(--success-color);
            border: 1px solid rgba(39, 174, 96, 0.3);
        }
        
        .db-status.offline {
            background: rgba(231, 76, 60, 0.1);
            color: var(--accent-color);
            border: 1px solid rgba(231, 76, 60, 0.3);
        }
        
        .sync-spinner {
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Loading States */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            color: var(--secondary-color);
        }
        
        /* Error Messages */
        .error-message {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            border: 1px solid #f5c6cb;
            border-radius: var(--border-radius);
            padding: 1.2rem;
            margin-bottom: 1.5rem;
            color: #721c24;
            display: none;
            align-items: center;
            gap: 12px;
            box-shadow: var(--shadow-soft);
        }
        
        footer {
            background: var(--gradient-primary);
            color: white;
            text-align: center;
            padding: 2rem 0;
            margin-top: 3rem;
        }
        
        footer a {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
        }
        
        footer a:hover {
            color: white;
            text-decoration: underline;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-links {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .nav-links li {
                margin: 0;
            }
            
            .form-container {
                padding: 1.8rem;
            }
            
            .feature-cards {
                flex-direction: column;
            }
            
            .team-members {
                flex-direction: column;
            }
            
            .filters {
                flex-direction: column;
            }
            
            .issue-actions {
                flex-direction: column;
            }
            
            .admin-issue-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .stats {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <div class="logo">
                    <i class="fas fa-shield-alt"></i>
                    Local Issue Reporter
                </div>
                <ul class="nav-links">
                    <li><a href="#" class="nav-link active" data-target="home"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="#" class="nav-link" data-target="report"><i class="fas fa-plus-circle"></i> Report Issue</a></li>
                    <li><a href="#" class="nav-link" data-target="issues"><i class="fas fa-list-alt"></i> View Issues</a></li>
                    <li><a href="#" class="nav-link" data-target="admin"><i class="fas fa-user-shield"></i> Admin</a></li>
                    <li><a href="#" class="nav-link" data-target="about"><i class="fas fa-info-circle"></i> About</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <div class="container">
            <section id="home" class="content-section active">
                <div class="home-content">
                    <h2>Welcome to Local Issue Reporter</h2>
                    <p>A modern, secure platform for reporting and tracking local issues in your community with advanced features and real-time updates.</p>
                    
                    <div class="feature-cards">
                        <div class="feature-card">
                            <i class="fas fa-lock"></i>
                            <h3>Secure Reporting</h3>
                            <p>All data is validated and encrypted for maximum security. Your privacy is our highest priority with end-to-end protection.</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-chart-line"></i>
                            <h3>Track Issues</h3>
                            <p>Monitor the status of reported issues in real-time with detailed progress tracking and status updates.</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-users"></i>
                            <h3>Community Focused</h3>
                            <p>Help improve your local area by reporting issues that matter. Collaborate with neighbors and local authorities.</p>
                        </div>
                    </div>
                    
                    <div style="margin-top: 3rem; display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                        <button class="submit-btn" style="width: auto; padding: 1rem 2rem;" onclick="showSection('report')">
                            <i class="fas fa-plus-circle"></i> Report an Issue
                        </button>
                        <button class="submit-btn" style="width: auto; padding: 1rem 2rem; background: var(--gradient-secondary);" onclick="showSection('issues')">
                            <i class="fas fa-list-alt"></i> View Existing Issues
                        </button>
                    </div>
                </div>
            </section>
            
            <section id="report" class="content-section">
                <h1 class="page-title">Report a Local Issue</h1>
                
               
                    
                    <div class="secure-connection">
                        <i class="fas fa-shield-alt"></i>
                        Secure Connection - All data is validated and encrypted for security
                    </div>
                    
                    <hr>
                    
                    <div class="security-notice">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div>
                            <strong>Security Notice:</strong> Your reports are completely anonymous to protect your privacy. 
                            Never include personal sensitive information in reports.
                        </div>
                    </div>
                    
                    <div class="success-message" id="successMessage">
                        <i class="fas fa-check-circle"></i>
                        <div>
                            <strong>Issue reported successfully!</strong> Thank you for your contribution to the community.
                        </div>
                    </div>
                    
                    <div id="errorMessage" class="error-message">
                        <i class="fas fa-exclamation-circle"></i>
                        <div id="errorText"></div>
                    </div>
                    
                    <form id="issueForm">
                        <div class="form-group">
                            <label for="location" class="required">
                                <i class="fas fa-map-marker-alt"></i>
                                Issue Location
                            </label>
                            <input type="text" id="location" name="location" placeholder="Where is the issue located?" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="title" class="required">
                                <i class="fas fa-heading"></i>
                                Issue Title
                            </label>
                            <input type="text" id="title" name="title" placeholder="Brief title for the issue" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="description" class="required">
                                <i class="fas fa-file-alt"></i>
                                Describe the issue in detail
                            </label>
                            <textarea id="description" name="description" placeholder="Minimum 10 characters, avoid personal information" minlength="10" maxlength="2000" required></textarea>
                            <div class="char-counter"><span id="charCount">0</span>/2000 characters</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="priority" class="required">
                                <i class="fas fa-exclamation-circle"></i>
                                Priority Level
                            </label>
                            <select id="priority" name="priority" required>
                                <option value="">Select priority</option>
                                <option value="low">Low - Minor inconvenience</option>
                                <option value="medium">Medium - Needs attention</option>
                                <option value="high">High - Significant impact</option>
                                <option value="critical">Critical - Urgent attention required</option>
                            </select>
                        </div>
                        
                        <div class="checkbox-group">
                            <input type="checkbox" id="privacy" name="privacy" required>
                            <label for="privacy">
                                I agree to the Privacy Policy and understand that this report is anonymous and publicly visible to community members and local authorities.
                            </label>
                        </div>
                        
                        <button type="submit" class="submit-btn" id="submitBtn">
                            <i class="fas fa-paper-plane"></i>
                            Submit Secure Report
                        </button>
                    </form>
                </div>
            </section>
            
            <section id="issues" class="content-section">
                <h1 class="page-title">View Reported Issues</h1>
                
                <div class="form-container">
                    <div class="secure-connection">
                        <i class="fas fa-eye"></i>
                        All issues are publicly visible for community transparency
                    </div>
                    
                    <hr>
                    
                    <!-- Statistics -->
                    <div class="stats" id="statsContainer">
                        <div class="loading">
                            <i class="fas fa-spinner sync-spinner"></i>
                            <span>Loading statistics...</span>
                        </div>
                    </div>
                    
                    <!-- Filters -->
                    <div class="filters">
                        <div class="filter-group">
                            <label for="statusFilter">
                                <i class="fas fa-filter"></i>
                                Filter by Status
                            </label>
                            <select id="statusFilter" onchange="filterIssues()">
                                <option value="all">All Statuses</option>
                                <option value="open">Open</option>
                                <option value="in-progress">In Progress</option>
                                <option value="resolved">Resolved</option>
                                <option value="closed">Closed</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="priorityFilter">
                                <i class="fas fa-sort-amount-down"></i>
                                Filter by Priority
                            </label>
                            <select id="priorityFilter" onchange="filterIssues()">
                                <option value="all">All Priorities</option>
                                <option value="low">Low</option>
                                <option value="medium">Medium</option>
                                <option value="high">High</option>
                                <option value="critical">Critical</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="searchFilter">
                                <i class="fas fa-search"></i>
                                Search Issues
                            </label>
                            <input type="text" id="searchFilter" placeholder="Search by title, description, or location..." onkeyup="filterIssues()">
                        </div>
                    </div>
                    
                    <div class="issues-list" id="issuesList">
                        <div class="loading">
                            <i class="fas fa-spinner sync-spinner"></i>
                            <span>Loading issues...</span>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="admin" class="content-section">
                <h1 class="page-title">Admin Panel</h1>
                
                <div class="form-container">
                    <div id="adminLogin" class="admin-login">
                        <h2>Admin Login</h2>
                        <div class="admin-login-form">
                            <div class="form-group">
                                <label for="adminUsername">
                                    <i class="fas fa-user"></i>
                                    Username
                                </label>
                                <input type="text" id="adminUsername" placeholder="Enter admin username">
                            </div>
                            <div class="form-group">
                                <label for="adminPassword">
                                    <i class="fas fa-key"></i>
                                    Password
                                </label>
                                <div class="password-container">
                                    <input type="password" id="adminPassword" placeholder="Enter admin password" required>
                                    <button type="button" class="toggle-password" id="togglePassword">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            <button class="submit-btn" onclick="adminLogin()">
                                <i class="fas fa-sign-in-alt"></i>
                                Login to Admin Panel
                            </button>
                        </div>
                    </div>
                    
                    <div id="adminPanel" class="admin-panel">
                        <div class="admin-header">
                            <h2>Issue Management</h2>
                            <button class="btn btn-danger" onclick="adminLogout()">
                                <i class="fas fa-sign-out-alt"></i>
                                Logout
                            </button>
                        </div>
                        
                        <div class="admin-email-notification">
                            <i class="fas fa-envelope"></i>
                            <div>
                                <strong>Email Notifications:</strong> All new issues are automatically sent to pratikgadadare004@gmail.com
                            </div>
                        </div>
                        
                        <div class="admin-actions">
                            <button class="btn btn-info" onclick="refreshAdminIssues()">
                                <i class="fas fa-sync-alt"></i>
                                Refresh
                            </button>
                            <button class="btn btn-success" onclick="markAllAsReviewed()">
                                <i class="fas fa-check-double"></i>
                                Mark All as Reviewed
                            </button>
                        </div>
                        
                        <div class="filters">
                            <div class="filter-group">
                                <label for="adminStatusFilter">
                                    <i class="fas fa-filter"></i>
                                    Filter by Status
                                </label>
                                <select id="adminStatusFilter" onchange="filterAdminIssues()">
                                    <option value="all">All Statuses</option>
                                    <option value="open">Open</option>
                                    <option value="in-progress">In Progress</option>
                                    <option value="resolved">Resolved</option>
                                    <option value="closed">Closed</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label for="adminPriorityFilter">
                                    <i class="fas fa-sort-amount-down"></i>
                                    Filter by Priority
                                </label>
                                <select id="adminPriorityFilter" onchange="filterAdminIssues()">
                                    <option value="all">All Priorities</option>
                                    <option value="low">Low</option>
                                    <option value="medium">Medium</option>
                                    <option value="high">High</option>
                                    <option value="critical">Critical</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label for="adminSearchFilter">
                                    <i class="fas fa-search"></i>
                                    Search Issues
                                </label>
                                <input type="text" id="adminSearchFilter" placeholder="Search by title, description, or location..." onkeyup="filterAdminIssues()">
                            </div>
                        </div>
                        
                        <div id="adminIssuesList">
                            <div class="loading">
                                <i class="fas fa-spinner sync-spinner"></i>
                                <span>Loading admin issues...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="about" class="content-section">
                <h1 class="page-title">About Secure Issue Reporter</h1>
                
                <div class="form-container">
                    <div class="about-content">
                        <h2>Our Mission</h2>
                        <p>Secure Issue Reporter is a modern, community-focused platform designed to help residents report and track local issues efficiently and securely. We believe in transparent communication between community members and local authorities while maintaining the highest standards of data protection.</p>
                        
                        <h2>How It Works</h2>
                        <p>Our platform allows you to securely report issues in your neighborhood with end-to-end encryption and validation. All reports are forwarded to the appropriate local authorities while maintaining your privacy through advanced anonymization techniques.</p>
                        
                        <h2>Security & Privacy</h2>
                        <p>We take security seriously with multiple layers of protection. All data is encrypted, validated to prevent malicious input, and stored securely. We never share personal information without explicit consent, and we follow strict data protection protocols compliant with global standards.</p>
                        
                        <h2>Our Team</h2>
                        <div class="team-members">
                            <div class="team-member">
                                <div class="member-photo">PG</div>
                                <h3>Pratik Gadadare</h3>
                                <p>Developer</p>
                                <p style="font-size: 0.9rem; color: #666; margin-top: 0.5rem;">Security & Infrastructure</p>
                            </div>
                            <div class="team-member">
                                <div class="member-photo">RA</div>
                                <h3>Rushikesh Anuse</h3>
                                <p>Security Lead</p>
                                <p style="font-size: 0.9rem; color: #666; margin-top: 0.5rem;">Cybersecurity & Encryption</p>
                            </div>
                            <div class="team-member">
                                <div class="member-photo">SP</div>
                                <h3>Soham Patil</h3>
                                <p>Community Manager</p>
                                <p style="font-size: 0.9rem; color: #666; margin-top: 0.5rem;">User Experience & Outreach</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 Secure Local Issue Platform | <a href="#"><i class="fas fa-shield-alt"></i> Cybersecurity Protected</a></p>
            <p style="margin-top: 0.5rem; opacity: 0.8; font-size: 0.9rem;">
                Built with <i class="fas fa-heart" style="color: #e74c3c;"></i> for secure community engagement
            </p>
        </div>
    </footer>

    <script>
        // Application State
        let issues = [];
        let isAdminLoggedIn = false;
        let dbInitialized = false;
        let unsubscribeIssues = null;
        
        // Admin credentials
        const ADMIN_USERNAME = "admin";
        const ADMIN_PASSWORD = "admin123";
        const ADMIN_EMAIL = "pratikgadadare004@gmail.com";
        
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDikaZhBS1Ra0oonREv4z8QEPBD-hqKFgU",
            authDomain: "local-issue-platform.firebaseapp.com",
            projectId: "local-issue-platform",
            storageBucket: "local-issue-platform.firebasestorage.app",
            messagingSenderId: "198800362429",
            appId: "1:198800362429:web:8e0a0d1d0fc305e5f120d4",
            measurementId: "G-2HZZV0ZMH6"
        };
        
        // Initialize Firebase
        let firebaseApp;
        let db;
        
        try {
            firebaseApp = firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
            console.log("Firebase initialized successfully");
        } catch (error) {
            console.error("Firebase initialization failed:", error);
        }
        
        // Initialize EmailJS with your Public Key
        (function() {
            emailjs.init("oM2BTI_gGQEg0q7s9"); // Replace with your actual EmailJS public key
            console.log("EmailJS initialized");
        })();
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeDatabase();
            setupEventListeners();
            setupPasswordToggle();
        });
        
        // Setup password visibility toggle
        function setupPasswordToggle() {
            const togglePassword = document.getElementById('togglePassword');
            const passwordInput = document.getElementById('adminPassword');
            
            if (togglePassword && passwordInput) {
                togglePassword.addEventListener('click', function() {
                    const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                    passwordInput.setAttribute('type', type);
                    
                    // Toggle eye icon
                    const icon = this.querySelector('i');
                    if (type === 'password') {
                        icon.className = 'fas fa-eye';
                    } else {
                        icon.className = 'fas fa-eye-slash';
                    }
                });
            }
        }
        
        // Initialize Firebase Database
        async function initializeDatabase() {
            try {
                if (!db) {
                    throw new Error("Firebase not available");
                }
                
                // Update UI to show connected status
                updateDbStatus(true);
                dbInitialized = true;
                
                // Set up real-time listener for issues
                setupIssuesListener();
                
                console.log("Firebase database initialized successfully");
            } catch (error) {
                console.error("Failed to initialize database:", error);
                updateDbStatus(false);
                showError("Database connection failed. Using offline mode.");
            }
        }
        
        // Set up real-time listener for issues
        function setupIssuesListener() {
            if (!db) return;
            
            // Unsubscribe from previous listener if exists
            if (unsubscribeIssues) {
                unsubscribeIssues();
            }
            
            // Set up real-time listener
            unsubscribeIssues = db.collection('issues')
                .orderBy('createdAt', 'desc')
                .onSnapshot(snapshot => {
                    issues = [];
                    snapshot.forEach(doc => {
                        const issue = doc.data();
                        issue.id = doc.id;
                        issues.push(issue);
                    });
                    
                    console.log(`Real-time update: ${issues.length} issues loaded`);
                    
                    // Update UI
                    displayIssues();
                    updateStats();
                    
                    // If we're in admin panel and admin is logged in, update admin view too
                    if (isAdminLoggedIn && document.getElementById('adminPanel').style.display !== 'none') {
                        displayAdminIssues();
                    }
                }, error => {
                    console.error("Error in real-time listener:", error);
                    updateDbStatus(false);
                });
        }
        
        // Update database status indicator
       function updateDbStatus(online) {
            const dbStatus = document.getElementById('dbStatus');
            if (dbStatus) {
                if (online) {
                    dbStatus.className = 'db-status online';
                    dbStatus.innerHTML = '<i class="fas fa-database"></i><span>Connected to Cloud Database</span><span style="margin-left: 10px;"><i class="fas fa-sync-alt sync-spinner"></i> Live</span>';
                } else {
                    dbStatus.className = 'db-status offline';
                    dbStatus.innerHTML = '<i class="fas fa-database"></i><span>Offline Mode - Data may not be saved</span>';
                }
            }
        }
        
        // Show error message
        function showError(message) {
            const errorEl = document.getElementById('errorMessage');
            const errorText = document.getElementById('errorText');
            
            if (errorEl && errorText) {
                errorText.textContent = message;
                errorEl.style.display = 'flex';
                
                // Auto-hide after 5 seconds
                setTimeout(() => {
                    errorEl.style.display = 'none';
                }, 5000);
            }
        }
        
        // Hide error message
        function hideError() {
            const errorEl = document.getElementById('errorMessage');
            if (errorEl) {
                errorEl.style.display = 'none';
            }
        }
        
        // Save issue to Firebase
        async function saveIssue(issue) {
            if (!dbInitialized) {
                throw new Error("Database not initialized");
            }
            
            try {
                // Add timestamp
                issue.createdAt = firebase.firestore.FieldValue.serverTimestamp();
                issue.updatedAt = firebase.firestore.FieldValue.serverTimestamp();
                
                // Save to Firestore
                const docRef = await db.collection('issues').add(issue);
                console.log("Issue saved to Firebase with ID:", docRef.id);
                
                return docRef.id;
            } catch (error) {
                console.error("Error saving issue to Firebase:", error);
                throw error;
            }
        }
        
        // Update issue in Firebase
        async function updateIssue(issueId, updates) {
            if (!dbInitialized) {
                throw new Error("Database not initialized");
            }
            
            try {
                updates.updatedAt = firebase.firestore.FieldValue.serverTimestamp();
                
                await db.collection('issues').doc(issueId).update(updates);
                console.log("Issue updated in Firebase");
            } catch (error) {
                console.error("Error updating issue in Firebase:", error);
                throw error;
            }
        }
        
        // Delete issue from Firebase
        async function deleteIssueFromDb(issueId) {
            if (!dbInitialized) {
                throw new Error("Database not initialized");
            }
            
            try {
                await db.collection('issues').doc(issueId).delete();
                console.log("Issue deleted from Firebase");
            } catch (error) {
                console.error("Error deleting issue from Firebase:", error);
                throw error;
            }
        }
        
        // Setup event listeners
        function setupEventListeners() {
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const target = this.getAttribute('data-target');
                    showSection(target);
                    
                    navLinks.forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            
            const descriptionTextarea = document.getElementById('description');
            const charCount = document.getElementById('charCount');
            
            if (descriptionTextarea) {
                descriptionTextarea.addEventListener('input', function() {
                    const currentLength = this.value.length;
                    charCount.textContent = currentLength;
                    
                    if (currentLength < 10) {
                        charCount.style.color = 'var(--accent-color)';
                    } else if (currentLength > 1900) {
                        charCount.style.color = 'var(--warning-color)';
                    } else {
                        charCount.style.color = 'var(--success-color)';
                    }
                });
            }
            
            const issueForm = document.getElementById('issueForm');
            if (issueForm) {
                issueForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    // Show loading state
                    const submitBtn = document.getElementById('submitBtn');
                    const originalText = submitBtn.innerHTML;
                    submitBtn.innerHTML = '<i class="fas fa-spinner sync-spinner"></i> Submitting...';
                    submitBtn.disabled = true;
                    
                    // Hide any previous errors
                    hideError();
                    
                    try {
                        const location = document.getElementById('location').value;
                        const title = document.getElementById('title').value;
                        const description = document.getElementById('description').value;
                        const priority = document.getElementById('priority').value;
                        const privacy = document.getElementById('privacy').checked;
                        
                        // Validation
                        if (description.length < 10) {
                            throw new Error('Description must be at least 10 characters long');
                        }
                        
                        if (!priority) {
                            throw new Error('Please select a priority level');
                        }
                        
                        if (!privacy) {
                            throw new Error('You must agree to the Privacy Policy');
                        }
                        
                        const newIssue = {
                            location: location,
                            title: title,
                            description: description,
                            priority: priority,
                            status: "open",
                            date: new Date().toISOString().split('T')[0]
                        };
                        
                        // Save to database
                        await saveIssue(newIssue);
                        
                        // Send email to admin
                        await sendEmailToAdmin(newIssue);
                        
                        // Show success message
                        const successMessage = document.getElementById('successMessage');
                        successMessage.classList.add('show');
                        
                        // Clear form for next report
                        issueForm.reset();
                        if (charCount) {
                            charCount.textContent = '0';
                            charCount.style.color = '#666';
                        }
                        
                        // Hide success message after 5 seconds
                        setTimeout(() => {
                            successMessage.classList.remove('show');
                        }, 5000);
                    } catch (error) {
                        console.error("Error submitting issue:", error);
                        showError(error.message || "Failed to submit issue. Please try again.");
                    } finally {
                        // Reset button state
                        submitBtn.innerHTML = originalText;
                        submitBtn.disabled = false;
                    }
                });
            }
        }
        
        // Display issues in the public view
        function displayIssues() {
            const issuesList = document.getElementById('issuesList');
            const statusFilter = document.getElementById('statusFilter')?.value || 'all';
            const priorityFilter = document.getElementById('priorityFilter')?.value || 'all';
            const searchFilter = document.getElementById('searchFilter')?.value.toLowerCase() || '';
            
            if (!issuesList) return;
            
            // Show loading if no issues yet
            if (issues.length === 0) {
                issuesList.innerHTML = '<div class="no-issues">No issues reported yet. <a href="#" onclick="showSection(\'report\')">Be the first to report an issue</a>.</div>';
                return;
            }
            
            const filteredIssues = issues.filter(issue => {
                const matchesStatus = statusFilter === 'all' || issue.status === statusFilter;
                const matchesPriority = priorityFilter === 'all' || issue.priority === priorityFilter;
                const matchesSearch = searchFilter === '' || 
                    issue.title.toLowerCase().includes(searchFilter) ||
                    issue.description.toLowerCase().includes(searchFilter) ||
                    issue.location.toLowerCase().includes(searchFilter);
                
                return matchesStatus && matchesPriority && matchesSearch;
            });
            
            if (filteredIssues.length === 0) {
                issuesList.innerHTML = '<div class="no-issues">No issues found matching your filters. <a href="#" onclick="showSection(\'report\')">Report a new issue</a>.</div>';
                return;
            }
            
            issuesList.innerHTML = '';
            
            filteredIssues.forEach(issue => {
                const issueElement = document.createElement('div');
                issueElement.className = `issue-item priority-${issue.priority}`;
                
                const statusText = getStatusText(issue.status);
                const statusClass = `status-${issue.status}`;
                const statusIcon = getStatusIcon(issue.status);
                
                issueElement.innerHTML = `
                    <div class="issue-title">
                        <i class="fas fa-tag"></i>
                        ${escapeHtml(issue.title)}
                        <span class="status-badge ${statusClass}">${statusIcon} ${statusText}</span>
                    </div>
                    <div class="issue-meta">
                        <div class="issue-meta-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Location: ${escapeHtml(issue.location)}</span>
                        </div>
                        <div class="issue-meta-item">
                            <i class="fas fa-flag"></i>
                            <span>Priority: ${capitalizeFirst(issue.priority)}</span>
                        </div>
                        <div class="issue-meta-item">
                            <i class="fas fa-calendar"></i>
                            <span>Date: ${issue.date}</span>
                        </div>
                    </div>
                    <div class="issue-description">${escapeHtml(issue.description)}</div>
                `;
                
                issuesList.appendChild(issueElement);
            });
        }
        
        // Display issues in admin panel
        function displayAdminIssues() {
            const adminIssuesList = document.getElementById('adminIssuesList');
            const statusFilter = document.getElementById('adminStatusFilter')?.value || 'all';
            const priorityFilter = document.getElementById('adminPriorityFilter')?.value || 'all';
            const searchFilter = document.getElementById('adminSearchFilter')?.value.toLowerCase() || '';
            
            if (!adminIssuesList) return;
            
            // Show loading if no issues yet
            if (issues.length === 0) {
                adminIssuesList.innerHTML = '<div class="no-issues">No issues reported yet.</div>';
                return;
            }
            
            const filteredIssues = issues.filter(issue => {
                const matchesStatus = statusFilter === 'all' || issue.status === statusFilter;
                const matchesPriority = priorityFilter === 'all' || issue.priority === priorityFilter;
                const matchesSearch = searchFilter === '' || 
                    issue.title.toLowerCase().includes(searchFilter) ||
                    issue.description.toLowerCase().includes(searchFilter) ||
                    issue.location.toLowerCase().includes(searchFilter);
                
                return matchesStatus && matchesPriority && matchesSearch;
            });
            
            if (filteredIssues.length === 0) {
                adminIssuesList.innerHTML = '<div class="no-issues">No issues found matching your filters.</div>';
                return;
            }
            
            adminIssuesList.innerHTML = '';
            
            filteredIssues.forEach(issue => {
                const issueElement = document.createElement('div');
                issueElement.className = `admin-issue-item priority-${issue.priority}`;
                
                const statusText = getStatusText(issue.status);
                const statusClass = `status-${issue.status}`;
                const statusIcon = getStatusIcon(issue.status);
                
                issueElement.innerHTML = `
                    <div class="admin-issue-title">
                        <i class="fas fa-tag"></i>
                        ${escapeHtml(issue.title)}
                        <span class="status-badge ${statusClass}">${statusIcon} ${statusText}</span>
                    </div>
                    <div class="admin-issue-meta">
                        <div class="admin-issue-meta-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Location: ${escapeHtml(issue.location)}</span>
                        </div>
                        <div class="admin-issue-meta-item">
                            <i class="fas fa-flag"></i>
                            <span>Priority: ${capitalizeFirst(issue.priority)}</span>
                        </div>
                        <div class="admin-issue-meta-item">
                            <i class="fas fa-calendar"></i>
                            <span>Date: ${issue.date}</span>
                        </div>
                    </div>
                    <div class="issue-description">${escapeHtml(issue.description)}</div>
                    <div class="admin-issue-actions">
                        <select class="admin-status-select" onchange="updateIssueStatus('${issue.id}', this.value)">
                            <option value="open" ${issue.status === 'open' ? 'selected' : ''}>Open</option>
                            <option value="in-progress" ${issue.status === 'in-progress' ? 'selected' : ''}>In Progress</option>
                            <option value="resolved" ${issue.status === 'resolved' ? 'selected' : ''}>Resolved</option>
                            <option value="closed" ${issue.status === 'closed' ? 'selected' : ''}>Closed</option>
                        </select>
                        <button class="btn btn-danger" onclick="deleteIssue('${issue.id}')">
                            <i class="fas fa-trash-alt"></i> Delete Issue
                        </button>
                    </div>
                `;
                
                adminIssuesList.appendChild(issueElement);
            });
        }
        
        // Filter functions
        function filterIssues() {
            displayIssues();
        }
        
        function filterAdminIssues() {
            displayAdminIssues();
        }
        
        // Update statistics
        function updateStats() {
            const statsContainer = document.getElementById('statsContainer');
            if (!statsContainer) return;
            
            const total = issues.length;
            const open = issues.filter(issue => issue.status === 'open').length;
            const inProgress = issues.filter(issue => issue.status === 'in-progress').length;
            const resolved = issues.filter(issue => issue.status === 'resolved').length;
            const closed = issues.filter(issue => issue.status === 'closed').length;
            
            statsContainer.innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${total}</div>
                    <div class="stat-label">Total Issues</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${open}</div>
                    <div class="stat-label">Open</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${inProgress}</div>
                    <div class="stat-label">In Progress</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${resolved}</div>
                    <div class="stat-label">Resolved</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${closed}</div>
                    <div class="stat-label">Closed</div>
                </div>
            `;
        }
        
        // Admin functions
        function adminLogin() {
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            
            if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
                isAdminLoggedIn = true;
                document.getElementById('adminLogin').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                displayAdminIssues();
            } else {
                alert('Invalid admin credentials. Please try again.');
            }
        }
        
        function adminLogout() {
            isAdminLoggedIn = false;
            document.getElementById('adminLogin').style.display = 'block';
            document.getElementById('adminPanel').style.display = 'none';
            document.getElementById('adminUsername').value = '';
            document.getElementById('adminPassword').value = '';
        }
        
        function refreshAdminIssues() {
            displayAdminIssues();
            alert('Admin issues refreshed!');
        }
        
        async function markAllAsReviewed() {
            if (confirm('Are you sure you want to mark all open issues as in-progress?')) {
                try {
                    const updates = [];
                    issues.forEach(issue => {
                        if (issue.status === 'open') {
                            updates.push(updateIssue(issue.id, { status: 'in-progress' }));
                        }
                    });
                    
                    await Promise.all(updates);
                    alert('All open issues have been marked as in-progress!');
                } catch (error) {
                    console.error("Error updating issues:", error);
                    showError("Failed to update some issues. Please try again.");
                }
            }
        }
        
        async function updateIssueStatus(issueId, newStatus) {
            try {
                await updateIssue(issueId, { status: newStatus });
            } catch (error) {
                console.error("Error updating issue status:", error);
                showError("Failed to update issue status. Please try again.");
            }
        }
        
        async function deleteIssue(issueId) {
            if (confirm('Are you sure you want to delete this issue? This action cannot be undone.')) {
                try {
                    await deleteIssueFromDb(issueId);
                } catch (error) {
                    console.error("Error deleting issue:", error);
                    showError("Failed to delete issue. Please try again.");
                }
            }
        }
        
        // Navigation
        function showSection(sectionId) {
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => {
                section.classList.remove('active');
            });
            
            document.getElementById(sectionId).classList.add('active');
            
            if (sectionId === 'issues') {
                displayIssues();
                updateStats();
            } else if (sectionId === 'admin') {
                // Reset admin panel when showing it
                document.getElementById('adminLogin').style.display = 'block';
                document.getElementById('adminPanel').style.display = 'none';
                document.getElementById('adminUsername').value = '';
                document.getElementById('adminPassword').value = '';
            }
        }
        
        // Email sending function using EmailJS
        async function sendEmailToAdmin(issueData) {
            try {
                const templateParams = {
                    to_email: ADMIN_EMAIL,
                    from_name: 'Issue Reporter System',
                    subject: `New Issue Reported: ${issueData.title}`,
                    message: `
                        A new issue has been reported in your community:
                        
                        Location: ${issueData.location}
                        Title: ${issueData.title}
                        Priority: ${issueData.priority.toUpperCase()}
                        Description: ${issueData.description}
                        
                        Date Reported: ${new Date().toLocaleString()}
                        
                        Please log in to the admin panel to review this issue.
                    `,
                    reply_to: 'noreply@issuereporter.com'
                };

                // Use default EmailJS service and template
                const response = await emailjs.send(
                    'default_service', 
                    'template_default', 
                    templateParams
                );
                
                console.log('Email sent successfully to admin!', response.status, response.text);
                return true;
            } catch (error) {
                console.log('Failed to send email:', error);
                // Don't throw error - we don't want email failure to prevent issue submission
                // You can check the console for detailed error information
                console.log('EmailJS Error Details:', {
                    serviceId: 'service_65t6m7h',
                    templateId: 'template_70higwf',
                    error: error
                });
                return false;
            }
        }
        
        // Utility functions
        function getStatusText(status) {
            const statusMap = {
                'open': 'Open',
                'in-progress': 'In Progress',
                'resolved': 'Resolved',
                'closed': 'Closed'
            };
            return statusMap[status] || 'Unknown';
        }
        
        function getStatusIcon(status) {
            const iconMap = {
                'open': 'fas fa-exclamation-circle',
                'in-progress': 'fas fa-spinner',
                'resolved': 'fas fa-check-circle',
                'closed': 'fas fa-times-circle'
            };
            return `<i class="${iconMap[status] || 'fas fa-question'}"></i>`;
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        function capitalizeFirst(string) {
            return string.charAt(0).toUpperCase() + string.slice(1);
        }
    </script>
</body>
</html>
